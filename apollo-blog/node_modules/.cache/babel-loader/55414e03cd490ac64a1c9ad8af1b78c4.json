{"ast":null,"code":"import _classCallCheck from\"/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import axios from'axios';import{Container,Col,Row,Form,Button,Card,Alert}from'react-bootstrap';import{connect}from\"react-redux\";import{withRouter}from'react-router';//for ReactQuill. found at https://github.com/zenoamaro/react-quill\nimport ReactQuill from'react-quill';import'react-quill/dist/quill.snow.css';import\"../content/css/App.css\";import{create_article_url}from\"../backend-urls.js\";var CreateArticle=/*#__PURE__*/function(_React$Component){_inherits(CreateArticle,_React$Component);function CreateArticle(){var _getPrototypeOf2;var _this;_classCallCheck(this,CreateArticle);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(CreateArticle)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={error:null,//stores the error that comes from the backend\nloading:false,//to determine if the page is loading\nauthor:\"\",//stores the author (from the author input)\ntitle:\"\",//stores the title (from the title input)\nbody:\"\",//stores the body (from the body input)\narticle_submitted:false,//to determine if the article was successfully submitted (if true, display a banner at the bottom of the page and redirect the user)\ncountdown:3//countdown to redirect, after the article gets submitted\n};_this.handleAuthor=function(text){_this.setState({author:text.target.value});};_this.handleTitle=function(text){_this.setState({title:text.target.value});};_this.handleBody=function(text){_this.setState({body:text});};_this.submitForm=function(){// creates a new FormData object and adds all the form data to it\nvar article_data=new FormData();article_data.append('author',_this.props.username);article_data.append('title',_this.state.title);article_data.append('body',_this.state.body);axios.post(create_article_url,article_data,{headers:{Authorization:'Token '+_this.props.token}//DRF requires the token in the header to create an article\n}).then(function(response){_this.setState({article_submitted:true});console.log(response.data);}).catch(function(error){console.log(error);_this.setState({error:error,loading:false});});};_this.countdown=function(s){s-=1;_this.setState({countdown:s});};_this.handleValidated=function(){// return (this.state.author.length > 1 && this.state.title.length > 1 && this.state.body.length > 1)\nreturn!(_this.state.title.length>1&&_this.state.body.length>1);};_this.modules={toolbar:[[{'header':[1,2,false]}],['bold','italic','underline','strike','blockquote'],[{'list':'ordered'},{'list':'bullet'},{'indent':'-1'},{'indent':'+1'}],['link','image'],['clean']]};_this.formats=['header','bold','italic','underline','strike','blockquote','list','bullet','indent','link','image'];return _this;}_createClass(CreateArticle,[{key:\"componentDidMount\",value:function componentDidMount(){this.setState({author:this.props.username,loading:false});}},{key:\"render\",value:function render(){var _this$state=this.state,author=_this$state.author,title=_this$state.title,body=_this$state.body,article_submitted=_this$state.article_submitted,countdown=_this$state.countdown,error=_this$state.error;var _this$props=this.props,authenticated=_this$props.authenticated,token=_this$props.token;//for counting down the \"redirect\" (redirect in 3.. 2.. 1..)\n// article_submitted &&\n//   setInterval(function(){\n//     s = 5 ;\n//     this.setState({\n//\n//     })\n//   }  , 1000 );\nreturn React.createElement(Container,null,React.createElement(Row,null,React.createElement(Col,{xs:2}),React.createElement(Col,{xs:8},!authenticated?React.createElement(React.Fragment,null,React.createElement(Alert,{variant:\"danger\"},\"How did you get here? oops. \",React.createElement(\"a\",{href:\"/\"},\"go home\"))):React.createElement(React.Fragment,null,React.createElement(Card,null,React.createElement(Card.Header,null,React.createElement(\"h3\",null,\"Add an Article\")),React.createElement(Card.Body,null,React.createElement(Card.Text,null,React.createElement(Form,null,React.createElement(\"br\",null),React.createElement(Form.Row,null,React.createElement(Form.Label,null,\"Article Title:\"),React.createElement(Form.Control,{required:true,type:\"text\",placeholder:\"Enter Name\",onChange:this.handleTitle})),React.createElement(\"br\",null),React.createElement(Form.Row,null,React.createElement(Col,null,React.createElement(Form.Label,null,\"Article Body:\"),React.createElement(ReactQuill,{required:true,placeholder:\"Start Writing...\",onChange:this.handleBody,className:\"editor_form_control\",modules:this.modules,formats:this.formats,theme:\"snow\"}))))),React.createElement(\"br\",null),React.createElement(Button,{variant:\"primary\",onClick:this.submitForm,disabled:this.handleValidated()},\"Add Article\"))),error&&React.createElement(React.Fragment,null,React.createElement(\"br\",null),React.createElement(\"meta\",{\"http-equiv\":\"refresh\",content:\"3;url=/\"}),React.createElement(Alert,{variant:\"danger\"},\"Nice try buddy\")),article_submitted&&React.createElement(React.Fragment,null,React.createElement(\"br\",null),React.createElement(\"meta\",{\"http-equiv\":\"refresh\",content:\"3;url=/\"}),React.createElement(Alert,{variant:\"success\"},\"You successfully created an article! You will be redirected in \",countdown,\" seconds\"))))));}}]);return CreateArticle;}(React.Component);var mapStateToProps=function mapStateToProps(state){console.log(state.auth.token);return{loading:state.auth.loading,error:state.auth.error,token:state.auth.token,username:state.auth.username,authenticated:state.auth.token!==null};};export default withRouter(connect(mapStateToProps)(CreateArticle));","map":{"version":3,"sources":["/Users/connordavidson/Desktop/gcloud-apollo/apollo_blog_backend/apollo-blog/src/containers/CreateArticle.js"],"names":["React","axios","Container","Col","Row","Form","Button","Card","Alert","connect","withRouter","ReactQuill","create_article_url","CreateArticle","state","error","loading","author","title","body","article_submitted","countdown","handleAuthor","text","setState","target","value","handleTitle","handleBody","submitForm","article_data","FormData","append","props","username","post","headers","Authorization","token","then","response","console","log","data","catch","s","handleValidated","length","modules","toolbar","formats","authenticated","Component","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from 'axios';\nimport {\n  Container ,\n  Col ,\n  Row ,\n  Form ,\n  Button ,\n  Card ,\n  Alert ,\n\n} from 'react-bootstrap';\nimport { connect } from \"react-redux\";\nimport {withRouter} from 'react-router';\n\n//for ReactQuill. found at https://github.com/zenoamaro/react-quill\nimport ReactQuill from 'react-quill';\nimport 'react-quill/dist/quill.snow.css';\n\n\nimport \"../content/css/App.css\";\nimport {\n  create_article_url ,\n\n} from \"../backend-urls.js\" ;\n\n\n\n\n\nclass CreateArticle extends React.Component  {\n\n  state = {\n    error: null , //stores the error that comes from the backend\n    loading : false , //to determine if the page is loading\n    author : \"\" , //stores the author (from the author input)\n    title : \"\" , //stores the title (from the title input)\n    body : \"\" , //stores the body (from the body input)\n    article_submitted : false , //to determine if the article was successfully submitted (if true, display a banner at the bottom of the page and redirect the user)\n    countdown: 3 , //countdown to redirect, after the article gets submitted\n\n  }\n\n\n\n  componentDidMount(){\n    this.setState({\n      author: this.props.username ,\n      loading : false\n    })\n  }\n\n  handleAuthor = (text) => {\n    this.setState({\n      author: text.target.value\n    });\n  }\n\n  handleTitle = (text) => {\n    this.setState({\n      title: text.target.value\n    });\n  }\n\n  handleBody = (text) => {\n    this.setState({\n      body: text\n    });\n  }\n\n  submitForm = () => {\n\n    // creates a new FormData object and adds all the form data to it\n    var article_data = new FormData();\n    article_data.append('author' , this.props.username) ;\n    article_data.append('title' , this.state.title) ;\n    article_data.append('body' , this.state.body) ;\n\n\n    axios\n      .post(create_article_url , article_data ,\n        {\n          headers: { Authorization: 'Token ' + this.props.token } //DRF requires the token in the header to create an article\n        }\n      )\n      .then(response => {\n        this.setState({\n          article_submitted : true\n        })\n        console.log(response.data);\n      })\n      .catch(error => {\n        console.log(error)\n        this.setState({\n          error: error ,\n          loading : false\n        })\n      }) ;\n  }\n\n  countdown = ( s ) => {\n      s -= 1 ;\n      this.setState({\n        countdown : s\n      }) ;\n  }\n\n\n  handleValidated = () => {\n    // return (this.state.author.length > 1 && this.state.title.length > 1 && this.state.body.length > 1)\n    return !(this.state.title.length > 1 && this.state.body.length > 1)\n\n  }\n\n\n  modules = {\n    toolbar: [\n      [{ 'header': [1, 2, false] }],\n      ['bold', 'italic', 'underline','strike', 'blockquote'],\n      [{'list': 'ordered'}, {'list': 'bullet'}, {'indent': '-1'}, {'indent': '+1'}],\n      ['link', 'image'],\n      ['clean']\n    ],\n  }\n\n  formats = [\n    'header',\n    'bold', 'italic', 'underline', 'strike', 'blockquote',\n    'list', 'bullet', 'indent',\n    'link', 'image'\n  ]\n\n\n  render(){\n    const {\n      author ,\n      title ,\n      body ,\n      article_submitted ,\n      countdown ,\n      error ,\n\n    } = this.state ;\n\n    const {\n      authenticated ,\n      token ,\n\n    } = this.props ;\n\n\n\n    //for counting down the \"redirect\" (redirect in 3.. 2.. 1..)\n    // article_submitted &&\n    //   setInterval(function(){\n    //     s = 5 ;\n    //     this.setState({\n    //\n    //     })\n    //   }  , 1000 );\n\n\n    return(\n\n      <Container>\n        <Row>\n            <Col xs={2}>\n            </Col>\n            <Col xs={8} >\n\n            {\n              !authenticated ? (\n                <React.Fragment>\n                   {/*<meta http-equiv=\"refresh\" content=\"3;url=/\" />*/}\n                  <Alert variant=\"danger\">\n                    How did you get here? oops. <a href=\"/\">go home</a>\n                  </Alert>\n                </React.Fragment>\n              )\n              :\n              (\n                <React.Fragment>\n                <Card >\n                  <Card.Header><h3>Add an Article</h3></Card.Header>\n                  <Card.Body>\n                    <Card.Text>\n                      <Form>\n                        {/*\n                          <Form.Row>\n                            <Form.Label>Your Name:</Form.Label>\n                            <Form.Control\n                              required\n                              type=\"text\"\n                              placeholder=\"Enter Name\"\n                              // onChange = {this.handleAuthor}\n                            />\n                          </Form.Row>\n                        */}\n                        <br />\n                        <Form.Row>\n                          <Form.Label>Article Title:</Form.Label>\n                          <Form.Control\n                            required\n                            type=\"text\"\n                            placeholder=\"Enter Name\"\n                            onChange = {this.handleTitle}\n                          />\n                        </Form.Row>\n                        <br/>\n                        <Form.Row>\n                          <Col>\n                            <Form.Label>Article Body:</Form.Label>\n                            <ReactQuill\n                              required\n                              placeholder=\"Start Writing...\"\n                              onChange={this.handleBody}\n                              className=\"editor_form_control\"\n                              modules={this.modules}\n                              formats={this.formats}\n                              theme=\"snow\"\n                            />\n                          </Col>\n                        </Form.Row>\n                      </Form>\n\n                    </Card.Text>\n                    <br/>\n                    <Button\n                      variant=\"primary\"\n                      onClick={this.submitForm}\n                      disabled={this.handleValidated()}\n                    >\n                      Add Article\n                    </Button>\n                  </Card.Body>\n                </Card>\n\n                {\n                  error &&\n                    <React.Fragment>\n                      <br/>\n                      <meta http-equiv=\"refresh\" content=\"3;url=/\" />\n                      <Alert variant=\"danger\">\n                        Nice try buddy\n                      </Alert>\n                    </React.Fragment>\n                }\n                {\n                  article_submitted  &&\n                    <React.Fragment>\n                      <br/>\n                      <meta http-equiv=\"refresh\" content=\"3;url=/\" />\n                      <Alert variant=\"success\">\n                        You successfully created an article! You will be redirected in {countdown} seconds\n                      </Alert>\n                    </React.Fragment>\n                }\n                </React.Fragment>\n              )\n            }\n            </Col>\n        </Row>\n      </Container>\n    )\n  }\n\n}\n\nconst mapStateToProps = state => {\n  console.log(state.auth.token)\n  return {\n    loading: state.auth.loading ,\n    error: state.auth.error ,\n    token: state.auth.token ,\n    username: state.auth.username ,\n    authenticated: state.auth.token !== null ,\n  };\n};\n\nexport default\n  withRouter(\n    connect(\n      mapStateToProps,\n\n    )(CreateArticle)\n  );\n"]},"metadata":{},"sourceType":"module"}