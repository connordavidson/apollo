{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nimport React, { useCallback, useRef, useState } from 'react';\nimport { Range, Transforms } from 'slate';\nimport { useSlate } from 'slate-react';\nimport useAddPlugin from '../hooks/useAddPlugin';\nimport { getCurrentNodeDataWithPlugin } from '../hooks/useCurrentNodeDataWithPlugin';\nimport usePluginIsActive from '../hooks/usePluginIsActive';\nimport usePluginIsDisabled from '../hooks/usePluginIsDisabled';\nimport useRemovePlugin from '../hooks/useRemovePlugin';\nimport UniformsControls from '../pluginFactories/components/UniformsControls';\nimport ToolbarButton from './ToolbarButton';\n\nfunction PluginButton(props) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n\n  var plugin = props.plugin;\n  var hasControls = Boolean(plugin.Controls) || Boolean(plugin.schema);\n\n  var _l = __read(useState(false), 2),\n      showControls = _l[0],\n      setShowControls = _l[1];\n\n  var storedPropsRef = useRef();\n  var close = useCallback(function () {\n    return setShowControls(false);\n  }, []);\n  var isActive = usePluginIsActive(plugin);\n  var add = useAddPlugin(plugin);\n  var remove = useRemovePlugin(plugin);\n  var onClick = React.useCallback(function (e) {\n    e.preventDefault();\n\n    if (hasControls) {\n      if (!showControls) {\n        // store props\n        storedPropsRef.current = {\n          selection: editor.selection,\n          isActive: isActive,\n          data: getCurrentNodeDataWithPlugin(editor, plugin)\n        };\n      }\n\n      setShowControls(!showControls);\n    } else {\n      if (isActive) {\n        remove();\n      } else {\n        add();\n      }\n    }\n  }, [isActive, hasControls, showControls]);\n  var PassedControls = plugin.Controls;\n  var Controls = PassedControls || UniformsControls;\n  var isDisabled = usePluginIsDisabled(plugin);\n  var editor = useSlate();\n  var shouldInsertWithText = plugin.pluginType === 'component' && (!((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) || Range.isCollapsed((_d = (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current) === null || _d === void 0 ? void 0 : _d.selection)) && !((_f = (_e = storedPropsRef) === null || _e === void 0 ? void 0 : _e.current) === null || _f === void 0 ? void 0 : _f.isActive);\n  return React.createElement(React.Fragment, null, React.createElement(ToolbarButton, {\n    onClick: onClick,\n    disabled: isDisabled,\n    isActive: isActive,\n    icon: plugin.icon || plugin.pluginType === 'component' && plugin.deserialize.tagName\n  }), hasControls ? React.createElement(Controls, __assign({\n    schema: plugin.schema,\n    close: close,\n    open: showControls,\n    add: function (p) {\n      var _a, _b, _c;\n\n      if ((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) {\n        // restore selection before adding\n        Transforms.select(editor, (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current.selection);\n      }\n\n      add(p);\n    },\n    remove: function () {\n      var _a, _b, _c;\n\n      if ((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) {\n        // restore selection before removing\n        Transforms.select(editor, (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current.selection);\n      }\n\n      remove();\n    },\n    isActive: (_h = (_g = storedPropsRef) === null || _g === void 0 ? void 0 : _g.current) === null || _h === void 0 ? void 0 : _h.isActive,\n    shouldInsertWithText: shouldInsertWithText,\n    data: (_k = (_j = storedPropsRef) === null || _j === void 0 ? void 0 : _j.current) === null || _k === void 0 ? void 0 : _k.data\n  }, props)) : null);\n}\n\nexport default React.memo(PluginButton);","map":{"version":3,"sources":["../../src/Controls/PluginButton.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport React, { useCallback, useRef, useState } from 'react';\nimport { Range, Transforms } from 'slate';\nimport { useSlate } from 'slate-react';\nimport useAddPlugin from '../hooks/useAddPlugin';\nimport { getCurrentNodeDataWithPlugin } from '../hooks/useCurrentNodeDataWithPlugin';\nimport usePluginIsActive from '../hooks/usePluginIsActive';\nimport usePluginIsDisabled from '../hooks/usePluginIsDisabled';\nimport useRemovePlugin from '../hooks/useRemovePlugin';\nimport UniformsControls from '../pluginFactories/components/UniformsControls';\nimport ToolbarButton from './ToolbarButton';\nfunction PluginButton(props) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n    var plugin = props.plugin;\n    var hasControls = Boolean(plugin.Controls) || Boolean(plugin.schema);\n    var _l = __read(useState(false), 2), showControls = _l[0], setShowControls = _l[1];\n    var storedPropsRef = useRef();\n    var close = useCallback(function () { return setShowControls(false); }, []);\n    var isActive = usePluginIsActive(plugin);\n    var add = useAddPlugin(plugin);\n    var remove = useRemovePlugin(plugin);\n    var onClick = React.useCallback(function (e) {\n        e.preventDefault();\n        if (hasControls) {\n            if (!showControls) {\n                // store props\n                storedPropsRef.current = {\n                    selection: editor.selection,\n                    isActive: isActive,\n                    data: getCurrentNodeDataWithPlugin(editor, plugin),\n                };\n            }\n            setShowControls(!showControls);\n        }\n        else {\n            if (isActive) {\n                remove();\n            }\n            else {\n                add();\n            }\n        }\n    }, [isActive, hasControls, showControls]);\n    var PassedControls = plugin.Controls;\n    var Controls = PassedControls || UniformsControls;\n    var isDisabled = usePluginIsDisabled(plugin);\n    var editor = useSlate();\n    var shouldInsertWithText = plugin.pluginType === 'component' &&\n        (!((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) ||\n            Range.isCollapsed((_d = (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current) === null || _d === void 0 ? void 0 : _d.selection)) &&\n        !((_f = (_e = storedPropsRef) === null || _e === void 0 ? void 0 : _e.current) === null || _f === void 0 ? void 0 : _f.isActive);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(ToolbarButton, { onClick: onClick, disabled: isDisabled, isActive: isActive, icon: plugin.icon ||\n                (plugin.pluginType === 'component' && plugin.deserialize.tagName) }),\n        hasControls ? (React.createElement(Controls, __assign({ schema: plugin.schema, close: close, open: showControls, add: function (p) {\n                var _a, _b, _c;\n                if ((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) {\n                    // restore selection before adding\n                    Transforms.select(editor, (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current.selection);\n                }\n                add(p);\n            }, remove: function () {\n                var _a, _b, _c;\n                if ((_b = (_a = storedPropsRef) === null || _a === void 0 ? void 0 : _a.current) === null || _b === void 0 ? void 0 : _b.selection) {\n                    // restore selection before removing\n                    Transforms.select(editor, (_c = storedPropsRef) === null || _c === void 0 ? void 0 : _c.current.selection);\n                }\n                remove();\n            }, isActive: (_h = (_g = storedPropsRef) === null || _g === void 0 ? void 0 : _g.current) === null || _h === void 0 ? void 0 : _h.isActive, shouldInsertWithText: shouldInsertWithText, data: (_k = (_j = storedPropsRef) === null || _j === void 0 ? void 0 : _j.current) === null || _k === void 0 ? void 0 : _k.data }, props))) : null));\n}\nexport default React.memo(PluginButton);\n//# sourceMappingURL=PluginButton.js.map"]},"metadata":{},"sourceType":"module"}