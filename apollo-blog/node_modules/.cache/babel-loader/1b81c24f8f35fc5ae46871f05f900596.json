{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\n\nvar tslib_1 = require(\"tslib\");\n\nvar prop_types_1 = tslib_1.__importDefault(require(\"prop-types\"));\n\nvar get_1 = tslib_1.__importDefault(require(\"lodash/get\"));\n\nvar invariant_1 = tslib_1.__importDefault(require(\"invariant\"));\n\nvar isEqual_1 = tslib_1.__importDefault(require(\"lodash/isEqual\"));\n\nvar react_1 = require(\"react\");\n\nvar BaseForm_1 = tslib_1.__importDefault(require(\"./BaseForm\"));\n\nvar joinName_1 = tslib_1.__importDefault(require(\"./joinName\")); // Used for calculating labels and placeholders.\n\n\nvar flowingProp = function (prop, schema, state, fallback) {\n  var propDisabled = prop === '' || prop === false;\n  var propSet = prop !== undefined;\n  var schemaDisabled = schema === '' || schema === false;\n  var schemaValue = schema === true || schema === undefined ? fallback : schema;\n  var stateDisabled = !state;\n  var value = propDisabled || !propSet && (schemaDisabled || stateDisabled) ? '' : propSet ? prop === true ? schemaDisabled ? '' : schemaValue : prop : schemaValue;\n  return [value, schemaValue];\n};\n\nvar BaseField =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(BaseField, _super);\n\n  function BaseField() {\n    var _this = _super.apply(this, arguments) || this;\n\n    invariant_1[\"default\"](_this.context.uniforms, '<%s /> must be rendered within a form.', // @ts-ignore\n    _this.constructor.displayName);\n    _this.options = {\n      ensureValue: true,\n      explicitInitialValue: false,\n      includeParent: false,\n      overrideValue: false\n    };\n    _this.randomId = _this.context.uniforms.randomId();\n    _this.findValue = _this.findValue.bind(_this);\n    _this.findField = _this.findField.bind(_this);\n    _this.findError = _this.findError.bind(_this);\n    return _this;\n  }\n\n  BaseField.prototype.getChildContext = function () {\n    return {\n      uniforms: {\n        name: this.getChildContextName(),\n        error: this.getChildContextError(),\n        model: this.getChildContextModel(),\n        state: this.getChildContextState(),\n        schema: this.getChildContextSchema(),\n        onChange: this.getChildContextOnChange(),\n        onSubmit: this.getChildContextOnSubmit(),\n        randomId: this.context.uniforms.randomId\n      }\n    };\n  }; // eslint-disable-next-line complexity\n\n\n  BaseField.prototype.shouldComponentUpdate = function (nextProps, _, _a) {\n    var nextContext = _a.uniforms;\n    var prevProps = this.props;\n    var prevContext = this.context.uniforms;\n\n    if (!isEqual_1[\"default\"](prevProps, nextProps)) {\n      return true;\n    }\n\n    var _b = nextContext.state,\n        nextMap = _b.changedMap,\n        nextState = tslib_1.__rest(_b, [\"changedMap\"]);\n\n    var _c = prevContext.state,\n        prevMap = _c.changedMap,\n        prevState = tslib_1.__rest(_c, [\"changedMap\"]);\n\n    if (!isEqual_1[\"default\"](prevState, nextState)) {\n      return true;\n    }\n\n    var prevName = joinName_1[\"default\"](prevContext.name, prevProps.name);\n    var nextName = joinName_1[\"default\"](nextContext.name, nextProps.name);\n\n    if (prevName !== nextName) {\n      return true;\n    }\n\n    if (!isEqual_1[\"default\"](get_1[\"default\"](prevMap, prevName), get_1[\"default\"](nextMap, nextName))) {\n      return true;\n    } // Fields which are using parent props, need to be updated when parent value change\n\n\n    if (this.options.includeParent && nextName.indexOf('.') !== -1) {\n      var prevParentValue = get_1[\"default\"](prevContext.model, prevName.replace(/(.+)\\..+$/, '$1'));\n      var nextParentValue = get_1[\"default\"](nextContext.model, nextName.replace(/(.+)\\..+$/, '$1'));\n\n      if (!isEqual_1[\"default\"](prevParentValue, nextParentValue)) {\n        return true;\n      }\n    }\n\n    var prevValue = get_1[\"default\"](prevContext.model, prevName);\n    var nextValue = get_1[\"default\"](nextContext.model, nextName);\n\n    if (!isEqual_1[\"default\"](prevValue, nextValue)) {\n      return true;\n    }\n\n    if (prevContext.error !== nextContext.error) {\n      var prevError = prevContext.error && prevContext.schema.getError(prevName, prevContext.error);\n      var nextError = nextContext.error && nextContext.schema.getError(nextName, nextContext.error);\n\n      if (!isEqual_1[\"default\"](prevError, nextError)) {\n        return true;\n      } // Fields like List or Nest should update, whenever their children error has changed\n\n\n      if (nextValue === Object(nextValue) && !(nextValue instanceof Date)) {\n        return true;\n      }\n    }\n\n    if (nextContext.schema !== prevContext.schema) {\n      return true;\n    }\n\n    return false;\n  };\n\n  BaseField.prototype.getChildContextName = function () {\n    return joinName_1[\"default\"](null, this.context.uniforms.name, this.props.name);\n  };\n\n  BaseField.prototype.getChildContextError = function () {\n    return this.context.uniforms.error;\n  };\n\n  BaseField.prototype.getChildContextModel = function () {\n    return this.context.uniforms.model;\n  };\n\n  BaseField.prototype.getChildContextState = function () {\n    var state = this.context.uniforms.state;\n    var props = this.props;\n\n    var propagate = function (name) {\n      return props[name] === undefined || props[name] === null ? state[name] : !!props[name];\n    };\n\n    return tslib_1.__assign({}, state, {\n      label: propagate('label'),\n      disabled: propagate('disabled'),\n      placeholder: propagate('placeholder'),\n      showInlineError: propagate('showInlineError')\n    });\n  };\n\n  BaseField.prototype.getChildContextSchema = function () {\n    return this.context.uniforms.schema;\n  };\n\n  BaseField.prototype.getChildContextOnChange = function () {\n    return this.context.uniforms.onChange;\n  };\n\n  BaseField.prototype.getChildContextOnSubmit = function () {\n    return this.context.uniforms.onSubmit;\n  }; // eslint-disable-next-line complexity\n\n\n  BaseField.prototype.getFieldProps = function (name, options) {\n    var context = this.context.uniforms;\n    var props = this.props;\n    var state = this.getChildContextState();\n    options = Object.assign({}, this.options, options);\n\n    if (name === undefined) {\n      name = joinName_1[\"default\"](context.name, props.name);\n    }\n\n    var changed = !!get_1[\"default\"](context.state.changedMap, name);\n    var error = context.schema.getError(name, context.error);\n    var errorMessage = context.schema.getErrorMessage(name, context.error);\n    var field = context.schema.getField(name);\n    var fieldType = context.schema.getType(name);\n    var fields = context.schema.getSubfields(name);\n    var schemaProps = context.schema.getProps(name, tslib_1.__assign({}, state, props));\n    var initialValue = options.explicitInitialValue ? context.schema.getInitialValue(name, props) : undefined;\n    var parent = options.includeParent && name.indexOf('.') !== -1 ? this.getFieldProps(name.replace(/(.+)\\..+$/, '$1'), {\n      includeParent: false\n    }) : null;\n\n    var _a = flowingProp(props.label, schemaProps.label, state.label, ''),\n        label = _a[0],\n        none = _a[1];\n\n    var placeholder = flowingProp(props.placeholder, schemaProps.placeholder, state.placeholder, label || none)[0];\n    var value;\n\n    if (props.value === undefined || options.overrideValue) {\n      value = get_1[\"default\"](context.model, name);\n\n      if (value === undefined && !changed && !options.explicitInitialValue) {\n        value = context.schema.getInitialValue(name, props);\n      }\n    } // This prevents (un)controlled input change warning.\n    // More info: https://fb.me/react-controlled-components.\n\n\n    if (value === undefined && options.ensureValue) {\n      value = '';\n    }\n\n    return tslib_1.__assign({\n      // 0. Constant props.\n      findError: this.findError,\n      findField: this.findField,\n      findValue: this.findValue,\n      id: this.randomId\n    }, state, {\n      // 2. Calculated field props.\n      changed: changed,\n      error: error,\n      errorMessage: errorMessage,\n      field: field,\n      fieldType: fieldType,\n      fields: fields,\n      onChange: function (value, key) {\n        if (key === void 0) {\n          key = name;\n        }\n\n        return context.onChange(key, value);\n      },\n      parent: parent,\n      value: value\n    }, options.explicitInitialValue && {\n      initialValue: initialValue\n    }, schemaProps, props, (options.explicitInitialValue || options.overrideValue) && {\n      value: value\n    }, {\n      // 6. Calculated _special_ field props.\n      label: label,\n      name: name,\n      placeholder: placeholder\n    });\n  };\n\n  BaseField.prototype.findError = function (name) {\n    return this.context.uniforms.schema.getError(name, this.context.uniforms.error);\n  };\n\n  BaseField.prototype.findField = function (name) {\n    return this.context.uniforms.schema.getField(name);\n  };\n\n  BaseField.prototype.findValue = function (name) {\n    return get_1[\"default\"](this.context.uniforms.model, name);\n  };\n\n  BaseField.displayName = 'Field';\n  BaseField.propTypes = {\n    id: prop_types_1[\"default\"].string,\n    name: prop_types_1[\"default\"].string.isRequired,\n    disabled: prop_types_1[\"default\"].bool,\n    label: prop_types_1[\"default\"].oneOfType([prop_types_1[\"default\"].bool, prop_types_1[\"default\"].string, prop_types_1[\"default\"].node]),\n    placeholder: prop_types_1[\"default\"].oneOfType([prop_types_1[\"default\"].bool, prop_types_1[\"default\"].string])\n  };\n  BaseField.contextTypes = BaseForm_1[\"default\"].childContextTypes;\n  BaseField.childContextTypes = BaseForm_1[\"default\"].childContextTypes;\n  return BaseField;\n}(react_1.Component);\n\nexports[\"default\"] = BaseField;","map":{"version":3,"sources":["/Users/connordavidson/Desktop/apollo_blog/apollo-blog/node_modules/uniforms/BaseField.js"],"names":["exports","__esModule","tslib_1","require","prop_types_1","__importDefault","get_1","invariant_1","isEqual_1","react_1","BaseForm_1","joinName_1","flowingProp","prop","schema","state","fallback","propDisabled","propSet","undefined","schemaDisabled","schemaValue","stateDisabled","value","BaseField","_super","__extends","_this","apply","arguments","context","uniforms","constructor","displayName","options","ensureValue","explicitInitialValue","includeParent","overrideValue","randomId","findValue","bind","findField","findError","prototype","getChildContext","name","getChildContextName","error","getChildContextError","model","getChildContextModel","getChildContextState","getChildContextSchema","onChange","getChildContextOnChange","onSubmit","getChildContextOnSubmit","shouldComponentUpdate","nextProps","_","_a","nextContext","prevProps","props","prevContext","_b","nextMap","changedMap","nextState","__rest","_c","prevMap","prevState","prevName","nextName","indexOf","prevParentValue","replace","nextParentValue","prevValue","nextValue","prevError","getError","nextError","Object","Date","propagate","__assign","label","disabled","placeholder","showInlineError","getFieldProps","assign","changed","errorMessage","getErrorMessage","field","getField","fieldType","getType","fields","getSubfields","schemaProps","getProps","initialValue","getInitialValue","parent","none","id","key","propTypes","string","isRequired","bool","oneOfType","node","contextTypes","childContextTypes","Component"],"mappings":"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","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar tslib_1 = require(\"tslib\");\nvar prop_types_1 = tslib_1.__importDefault(require(\"prop-types\"));\nvar get_1 = tslib_1.__importDefault(require(\"lodash/get\"));\nvar invariant_1 = tslib_1.__importDefault(require(\"invariant\"));\nvar isEqual_1 = tslib_1.__importDefault(require(\"lodash/isEqual\"));\nvar react_1 = require(\"react\");\nvar BaseForm_1 = tslib_1.__importDefault(require(\"./BaseForm\"));\nvar joinName_1 = tslib_1.__importDefault(require(\"./joinName\"));\n// Used for calculating labels and placeholders.\nvar flowingProp = function (prop, schema, state, fallback) {\n    var propDisabled = prop === '' || prop === false;\n    var propSet = prop !== undefined;\n    var schemaDisabled = schema === '' || schema === false;\n    var schemaValue = schema === true || schema === undefined ? fallback : schema;\n    var stateDisabled = !state;\n    var value = propDisabled || (!propSet && (schemaDisabled || stateDisabled))\n        ? ''\n        : propSet\n            ? prop === true\n                ? schemaDisabled\n                    ? ''\n                    : schemaValue\n                : prop\n            : schemaValue;\n    return [value, schemaValue];\n};\nvar BaseField = /** @class */ (function (_super) {\n    tslib_1.__extends(BaseField, _super);\n    function BaseField() {\n        var _this = _super.apply(this, arguments) || this;\n        invariant_1[\"default\"](_this.context.uniforms, '<%s /> must be rendered within a form.', \n        // @ts-ignore\n        _this.constructor.displayName);\n        _this.options = {\n            ensureValue: true,\n            explicitInitialValue: false,\n            includeParent: false,\n            overrideValue: false\n        };\n        _this.randomId = _this.context.uniforms.randomId();\n        _this.findValue = _this.findValue.bind(_this);\n        _this.findField = _this.findField.bind(_this);\n        _this.findError = _this.findError.bind(_this);\n        return _this;\n    }\n    BaseField.prototype.getChildContext = function () {\n        return {\n            uniforms: {\n                name: this.getChildContextName(),\n                error: this.getChildContextError(),\n                model: this.getChildContextModel(),\n                state: this.getChildContextState(),\n                schema: this.getChildContextSchema(),\n                onChange: this.getChildContextOnChange(),\n                onSubmit: this.getChildContextOnSubmit(),\n                randomId: this.context.uniforms.randomId\n            }\n        };\n    };\n    // eslint-disable-next-line complexity\n    BaseField.prototype.shouldComponentUpdate = function (nextProps, _, _a) {\n        var nextContext = _a.uniforms;\n        var prevProps = this.props;\n        var prevContext = this.context.uniforms;\n        if (!isEqual_1[\"default\"](prevProps, nextProps)) {\n            return true;\n        }\n        var _b = nextContext.state, nextMap = _b.changedMap, nextState = tslib_1.__rest(_b, [\"changedMap\"]);\n        var _c = prevContext.state, prevMap = _c.changedMap, prevState = tslib_1.__rest(_c, [\"changedMap\"]);\n        if (!isEqual_1[\"default\"](prevState, nextState)) {\n            return true;\n        }\n        var prevName = joinName_1[\"default\"](prevContext.name, prevProps.name);\n        var nextName = joinName_1[\"default\"](nextContext.name, nextProps.name);\n        if (prevName !== nextName) {\n            return true;\n        }\n        if (!isEqual_1[\"default\"](get_1[\"default\"](prevMap, prevName), get_1[\"default\"](nextMap, nextName))) {\n            return true;\n        }\n        // Fields which are using parent props, need to be updated when parent value change\n        if (this.options.includeParent && nextName.indexOf('.') !== -1) {\n            var prevParentValue = get_1[\"default\"](prevContext.model, prevName.replace(/(.+)\\..+$/, '$1'));\n            var nextParentValue = get_1[\"default\"](nextContext.model, nextName.replace(/(.+)\\..+$/, '$1'));\n            if (!isEqual_1[\"default\"](prevParentValue, nextParentValue)) {\n                return true;\n            }\n        }\n        var prevValue = get_1[\"default\"](prevContext.model, prevName);\n        var nextValue = get_1[\"default\"](nextContext.model, nextName);\n        if (!isEqual_1[\"default\"](prevValue, nextValue)) {\n            return true;\n        }\n        if (prevContext.error !== nextContext.error) {\n            var prevError = prevContext.error &&\n                prevContext.schema.getError(prevName, prevContext.error);\n            var nextError = nextContext.error &&\n                nextContext.schema.getError(nextName, nextContext.error);\n            if (!isEqual_1[\"default\"](prevError, nextError)) {\n                return true;\n            }\n            // Fields like List or Nest should update, whenever their children error has changed\n            if (nextValue === Object(nextValue) && !(nextValue instanceof Date)) {\n                return true;\n            }\n        }\n        if (nextContext.schema !== prevContext.schema) {\n            return true;\n        }\n        return false;\n    };\n    BaseField.prototype.getChildContextName = function () {\n        return joinName_1[\"default\"](null, this.context.uniforms.name, this.props.name);\n    };\n    BaseField.prototype.getChildContextError = function () {\n        return this.context.uniforms.error;\n    };\n    BaseField.prototype.getChildContextModel = function () {\n        return this.context.uniforms.model;\n    };\n    BaseField.prototype.getChildContextState = function () {\n        var state = this.context.uniforms.state;\n        var props = this.props;\n        var propagate = function (name) {\n            return props[name] === undefined || props[name] === null\n                ? state[name]\n                : !!props[name];\n        };\n        return tslib_1.__assign({}, state, { label: propagate('label'), disabled: propagate('disabled'), placeholder: propagate('placeholder'), showInlineError: propagate('showInlineError') });\n    };\n    BaseField.prototype.getChildContextSchema = function () {\n        return this.context.uniforms.schema;\n    };\n    BaseField.prototype.getChildContextOnChange = function () {\n        return this.context.uniforms.onChange;\n    };\n    BaseField.prototype.getChildContextOnSubmit = function () {\n        return this.context.uniforms.onSubmit;\n    };\n    // eslint-disable-next-line complexity\n    BaseField.prototype.getFieldProps = function (name, options) {\n        var context = this.context.uniforms;\n        var props = this.props;\n        var state = this.getChildContextState();\n        options = Object.assign({}, this.options, options);\n        if (name === undefined) {\n            name = joinName_1[\"default\"](context.name, props.name);\n        }\n        var changed = !!get_1[\"default\"](context.state.changedMap, name);\n        var error = context.schema.getError(name, context.error);\n        var errorMessage = context.schema.getErrorMessage(name, context.error);\n        var field = context.schema.getField(name);\n        var fieldType = context.schema.getType(name);\n        var fields = context.schema.getSubfields(name);\n        var schemaProps = context.schema.getProps(name, tslib_1.__assign({}, state, props));\n        var initialValue = options.explicitInitialValue\n            ? context.schema.getInitialValue(name, props)\n            : undefined;\n        var parent = options.includeParent && name.indexOf('.') !== -1\n            ? this.getFieldProps(name.replace(/(.+)\\..+$/, '$1'), {\n                includeParent: false\n            })\n            : null;\n        var _a = flowingProp(props.label, schemaProps.label, state.label, ''), label = _a[0], none = _a[1];\n        var placeholder = flowingProp(props.placeholder, schemaProps.placeholder, state.placeholder, label || none)[0];\n        var value;\n        if (props.value === undefined || options.overrideValue) {\n            value = get_1[\"default\"](context.model, name);\n            if (value === undefined && !changed && !options.explicitInitialValue) {\n                value = context.schema.getInitialValue(name, props);\n            }\n        }\n        // This prevents (un)controlled input change warning.\n        // More info: https://fb.me/react-controlled-components.\n        if (value === undefined && options.ensureValue) {\n            value = '';\n        }\n        return tslib_1.__assign({ \n            // 0. Constant props.\n            findError: this.findError, findField: this.findField, findValue: this.findValue, id: this.randomId }, state, { \n            // 2. Calculated field props.\n            changed: changed,\n            error: error,\n            errorMessage: errorMessage,\n            field: field,\n            fieldType: fieldType,\n            fields: fields, onChange: function (value, key) {\n                if (key === void 0) { key = name; }\n                return context.onChange(key, value);\n            }, parent: parent,\n            value: value }, (options.explicitInitialValue && { initialValue: initialValue }), schemaProps, props, ((options.explicitInitialValue || options.overrideValue) && { value: value }), { \n            // 6. Calculated _special_ field props.\n            label: label,\n            name: name,\n            placeholder: placeholder });\n    };\n    BaseField.prototype.findError = function (name) {\n        return this.context.uniforms.schema.getError(name, this.context.uniforms.error);\n    };\n    BaseField.prototype.findField = function (name) {\n        return this.context.uniforms.schema.getField(name);\n    };\n    BaseField.prototype.findValue = function (name) {\n        return get_1[\"default\"](this.context.uniforms.model, name);\n    };\n    BaseField.displayName = 'Field';\n    BaseField.propTypes = {\n        id: prop_types_1[\"default\"].string,\n        name: prop_types_1[\"default\"].string.isRequired,\n        disabled: prop_types_1[\"default\"].bool,\n        label: prop_types_1[\"default\"].oneOfType([\n            prop_types_1[\"default\"].bool,\n            prop_types_1[\"default\"].string,\n            prop_types_1[\"default\"].node\n        ]),\n        placeholder: prop_types_1[\"default\"].oneOfType([prop_types_1[\"default\"].bool, prop_types_1[\"default\"].string])\n    };\n    BaseField.contextTypes = BaseForm_1[\"default\"].childContextTypes;\n    BaseField.childContextTypes = BaseForm_1[\"default\"].childContextTypes;\n    return BaseField;\n}(react_1.Component));\nexports[\"default\"] = BaseField;\n"]},"metadata":{},"sourceType":"script"}