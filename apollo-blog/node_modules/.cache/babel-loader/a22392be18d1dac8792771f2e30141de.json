{"ast":null,"code":"/*\n * This file is part of ORY Editor.\n *\n * ORY Editor is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ORY Editor is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with ORY Editor.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @license LGPL-3.0\n * @copyright 2016-2018 Aeneas Rekkas\n * @author Aeneas Rekkas <aeneas+oss@aeneas.io>\n *\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport semver from 'semver';\n/**\n * @class the class used to migrate plugin content between toVersion\n */\n\nvar Migration =\n/** @class */\nfunction () {\n  function Migration(config) {\n    // tslint:disable-next-line:no-any\n    this.migrate = function (state) {\n      return state;\n    };\n\n    var toVersion = config.toVersion,\n        migrate = config.migrate,\n        fromVersionRange = config.fromVersionRange;\n\n    if (!migrate || !toVersion || !fromVersionRange || semver.valid(toVersion) === null || semver.validRange(fromVersionRange) === null) {\n      throw new Error(\"A migration toVersion, fromVersionRange and migrate function must be defined, got \" + JSON.stringify(config));\n    }\n\n    this.toVersion = toVersion;\n    this.migrate = migrate;\n    this.fromVersionRange = fromVersionRange;\n  }\n\n  return Migration;\n}();\n\nexport { Migration };\n/**\n * @class the abstract class for content and layout plugins. It will be instantiated once and used for every cell that is equipped with it.\n */\n// tslint:disable-next-line:no-any\n\nvar Plugin =\n/** @class */\nfunction () {\n  // tslint:disable-next-line:no-any\n  function Plugin(config) {\n    /**\n     * Serialize a the plugin state\n     *\n     * @param raw the raw state.\n     * @returns the serialized state.\n     */\n    this.serialize = function (raw) {\n      return raw;\n    };\n    /**\n     * Unserialize the plugin state.\n     *\n     * @param state the plugin state.\n     * @returns the unserialized state.\n     */\n\n\n    this.unserialize = function (state) {\n      return state;\n    };\n    /**\n     * Will be called when the user presses the delete key. When returning a resolving promise,\n     * the cell will be removed. If the promise is rejected, nothing happens.\n     *\n     * @param e\n     * @param props\n     * @returns a promise\n     */\n\n\n    this.handleRemoveHotKey = function (e, props) {\n      return Promise.reject();\n    };\n    /**\n     * Will be called when the user presses the right or down key. When returning a resolving promise,\n     * the next cell will be focused. If the promise is rejected, focus stays the same.\n     *\n     * @param e\n     * @param props\n     * @returns a promise\n     */\n\n\n    this.handleFocusNextHotKey = function (e, props) {\n      return Promise.resolve();\n    };\n    /**\n     * Will be called when the user presses the left or up key. When returning a resolving promise,\n     * the next cell will be focused. If the promise is rejected, focus stays the same.\n     *\n     * @param e\n     * @param props\n     * @returns a promise\n     */\n\n\n    this.handleFocusPreviousHotKey = function (e, props) {\n      return Promise.resolve();\n    };\n    /**\n     * This function will be called when one of the plugin's cell is blurred.\n     *\n     * @param props\n     */\n\n\n    this.handleFocus = function (props, focusSource, ref) {\n      return null;\n    };\n    /**\n     * This function will be called when one of the plugin's cell is focused.\n     *\n     * @param props\n     */\n\n\n    this.handleBlur = function (props) {\n      return null;\n    };\n    /**\n     * Specify a custom reducer for the plugin's cell.\n     *\n     * @param state\n     * @param action\n     */\n    // tslint:disable-next-line:no-any\n\n\n    this.reducer = function (state, action) {\n      return state;\n    };\n\n    var name = config.name,\n        version = config.version,\n        Component = config.Component,\n        IconComponent = config.IconComponent,\n        text = config.text,\n        serialize = config.serialize,\n        unserialize = config.unserialize,\n        description = config.description,\n        handleRemoveHotKey = config.handleRemoveHotKey,\n        handleFocusNextHotKey = config.handleFocusNextHotKey,\n        handleFocusPreviousHotKey = config.handleFocusPreviousHotKey,\n        handleFocus = config.handleFocus,\n        handleBlur = config.handleBlur,\n        reducer = config.reducer,\n        migrations = config.migrations;\n\n    if (!name || !version || !Component) {\n      throw new Error(\"A plugin's version, name and Component must be defined, got \" + JSON.stringify(config));\n    }\n\n    this.name = name;\n    this.version = version;\n    this.Component = Component;\n    this.IconComponent = IconComponent;\n    this.text = text;\n    this.description = description;\n    this.config = config;\n    this.migrations = migrations ? migrations : [];\n    this.hideInMenu = config.hideInMenu;\n    this.serialize = serialize ? serialize.bind(this) : this.serialize;\n    this.unserialize = unserialize ? unserialize.bind(this) : this.unserialize;\n    this.handleRemoveHotKey = handleRemoveHotKey ? handleRemoveHotKey.bind(this) : this.handleRemoveHotKey;\n    this.handleFocusNextHotKey = handleFocusNextHotKey ? handleFocusNextHotKey.bind(this) : this.handleFocusNextHotKey;\n    this.handleFocusPreviousHotKey = handleFocusPreviousHotKey ? handleFocusPreviousHotKey.bind(this) : this.handleFocusPreviousHotKey;\n    this.handleFocus = handleFocus ? handleFocus.bind(this) : this.handleFocus;\n    this.handleBlur = handleBlur ? handleBlur.bind(this) : this.handleBlur;\n    this.reducer = reducer ? reducer.bind(this) : this.reducer;\n  }\n\n  return Plugin;\n}();\n\nexport { Plugin };\n/**\n * @class this is the base class for content plugins.\n */\n// tslint:disable-next-line:no-any\n\nvar ContentPlugin =\n/** @class */\nfunction (_super) {\n  __extends(ContentPlugin, _super); // tslint:disable-next-line:no-any\n\n\n  function ContentPlugin(config) {\n    var _this = _super.call(this, config) || this;\n    /**\n     * Create the plugin's initial state.\n     *\n     * @returns the initial state.\n     */\n\n\n    _this.createInitialState = function () {\n      return {};\n    };\n    /**\n     * Specify a custom reducer for the plugin's cell.\n     *\n     * @param state\n     * @param action\n     */\n    // tslint:disable-next-line:no-any\n\n\n    _this.reducer = function (state, action) {\n      return state;\n    };\n\n    var createInitialState = config.createInitialState,\n        _a = config.allowInlineNeighbours,\n        allowInlineNeighbours = _a === void 0 ? false : _a,\n        _b = config.isInlineable,\n        isInlineable = _b === void 0 ? false : _b;\n    _this.isInlineable = isInlineable;\n    _this.allowInlineNeighbours = allowInlineNeighbours;\n    _this.createInitialState = createInitialState ? createInitialState.bind(_this) : _this.createInitialState;\n    return _this;\n  }\n\n  return ContentPlugin;\n}(Plugin);\n\nexport { ContentPlugin };\n/**\n * @class this is the base class for layout plugins.\n */\n// tslint:disable-next-line:no-any\n\nvar LayoutPlugin =\n/** @class */\nfunction (_super) {\n  __extends(LayoutPlugin, _super);\n\n  function LayoutPlugin(config) {\n    var _this = _super.call(this, config) || this;\n    /**\n     * Create the plugin's initial state.\n     *\n     * @returns the initial state.\n     */\n\n\n    _this.createInitialState = function () {\n      return {};\n    };\n    /**\n     * Create the plugin's initial children (rows/cells).\n     *\n     * @returns the initial state.\n     */\n    // tslint:disable-next-line:no-any\n\n\n    _this.createInitialChildren = function () {\n      return [];\n    };\n\n    var createInitialState = config.createInitialState,\n        createInitialChildren = config.createInitialChildren; // child plugins\n\n    _this.plugins = config.plugins ? {\n      content: config.plugins.content ? config.plugins.content.map(function (p) {\n        return new ContentPlugin(p);\n      }) : null,\n      layout: config.plugins.layout ? config.plugins.layout.map(function (p) {\n        return new LayoutPlugin(p);\n      }) : null\n    } : null;\n    _this.createInitialState = createInitialState ? createInitialState.bind(_this) : _this.createInitialState;\n    _this.createInitialChildren = createInitialChildren ? createInitialChildren.bind(_this) : _this.createInitialChildren;\n    return _this;\n  }\n\n  return LayoutPlugin;\n}(Plugin);\n\nexport { LayoutPlugin };\n\nvar NativePlugin =\n/** @class */\nfunction (_super) {\n  __extends(NativePlugin, _super); // tslint:disable-next-line:no-any\n\n\n  function NativePlugin(config) {\n    var _this = _super.call(this, config) || this;\n    /**\n     * Create the plugin's initial children (rows/cells).\n     *\n     * @returns the initial state.\n     */\n\n\n    _this.createInitialChildren = function () {\n      return [];\n    };\n    /**\n     * Create the plugin's initial state.\n     *\n     * @returns the initial state.\n     */\n    // tslint:disable-next-line:no-any\n\n\n    _this.createInitialState = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return {};\n    };\n\n    var createInitialState = config.createInitialState,\n        _a = config.allowInlineNeighbours,\n        allowInlineNeighbours = _a === void 0 ? false : _a,\n        _b = config.isInlineable,\n        isInlineable = _b === void 0 ? false : _b,\n        createInitialChildren = config.createInitialChildren,\n        _c = config.type,\n        type = _c === void 0 ? 'content' : _c;\n    _this.isInlineable = isInlineable;\n    _this.allowInlineNeighbours = allowInlineNeighbours;\n    _this.createInitialState = createInitialState ? createInitialState.bind(_this) : _this.createInitialState;\n    _this.createInitialChildren = createInitialChildren ? createInitialChildren.bind(_this) : _this.createInitialChildren;\n    _this.type = type;\n    return _this;\n  }\n\n  return NativePlugin;\n}(Plugin);\n\nexport { NativePlugin };","map":{"version":3,"sources":["../../../src/service/plugin/classes.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * This file is part of ORY Editor.\n *\n * ORY Editor is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ORY Editor is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with ORY Editor.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @license LGPL-3.0\n * @copyright 2016-2018 Aeneas Rekkas\n * @author Aeneas Rekkas <aeneas+oss@aeneas.io>\n *\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport semver from 'semver';\n/**\n * @class the class used to migrate plugin content between toVersion\n */\nvar Migration = /** @class */ (function () {\n    function Migration(config) {\n        // tslint:disable-next-line:no-any\n        this.migrate = function (state) { return state; };\n        var toVersion = config.toVersion, migrate = config.migrate, fromVersionRange = config.fromVersionRange;\n        if (!migrate ||\n            !toVersion ||\n            !fromVersionRange ||\n            semver.valid(toVersion) === null ||\n            semver.validRange(fromVersionRange) === null) {\n            throw new Error(\"A migration toVersion, fromVersionRange and migrate function must be defined, got \" + JSON.stringify(config));\n        }\n        this.toVersion = toVersion;\n        this.migrate = migrate;\n        this.fromVersionRange = fromVersionRange;\n    }\n    return Migration;\n}());\nexport { Migration };\n/**\n * @class the abstract class for content and layout plugins. It will be instantiated once and used for every cell that is equipped with it.\n */\n// tslint:disable-next-line:no-any\nvar Plugin = /** @class */ (function () {\n    // tslint:disable-next-line:no-any\n    function Plugin(config) {\n        /**\n         * Serialize a the plugin state\n         *\n         * @param raw the raw state.\n         * @returns the serialized state.\n         */\n        this.serialize = function (raw) { return raw; };\n        /**\n         * Unserialize the plugin state.\n         *\n         * @param state the plugin state.\n         * @returns the unserialized state.\n         */\n        this.unserialize = function (state) { return state; };\n        /**\n         * Will be called when the user presses the delete key. When returning a resolving promise,\n         * the cell will be removed. If the promise is rejected, nothing happens.\n         *\n         * @param e\n         * @param props\n         * @returns a promise\n         */\n        this.handleRemoveHotKey = function (e, props) {\n            return Promise.reject();\n        };\n        /**\n         * Will be called when the user presses the right or down key. When returning a resolving promise,\n         * the next cell will be focused. If the promise is rejected, focus stays the same.\n         *\n         * @param e\n         * @param props\n         * @returns a promise\n         */\n        this.handleFocusNextHotKey = function (e, props) { return Promise.resolve(); };\n        /**\n         * Will be called when the user presses the left or up key. When returning a resolving promise,\n         * the next cell will be focused. If the promise is rejected, focus stays the same.\n         *\n         * @param e\n         * @param props\n         * @returns a promise\n         */\n        this.handleFocusPreviousHotKey = function (e, props) { return Promise.resolve(); };\n        /**\n         * This function will be called when one of the plugin's cell is blurred.\n         *\n         * @param props\n         */\n        this.handleFocus = function (props, focusSource, ref) { return null; };\n        /**\n         * This function will be called when one of the plugin's cell is focused.\n         *\n         * @param props\n         */\n        this.handleBlur = function (props) { return null; };\n        /**\n         * Specify a custom reducer for the plugin's cell.\n         *\n         * @param state\n         * @param action\n         */\n        // tslint:disable-next-line:no-any\n        this.reducer = function (state, action) { return state; };\n        var name = config.name, version = config.version, Component = config.Component, IconComponent = config.IconComponent, text = config.text, serialize = config.serialize, unserialize = config.unserialize, description = config.description, handleRemoveHotKey = config.handleRemoveHotKey, handleFocusNextHotKey = config.handleFocusNextHotKey, handleFocusPreviousHotKey = config.handleFocusPreviousHotKey, handleFocus = config.handleFocus, handleBlur = config.handleBlur, reducer = config.reducer, migrations = config.migrations;\n        if (!name || !version || !Component) {\n            throw new Error(\"A plugin's version, name and Component must be defined, got \" + JSON.stringify(config));\n        }\n        this.name = name;\n        this.version = version;\n        this.Component = Component;\n        this.IconComponent = IconComponent;\n        this.text = text;\n        this.description = description;\n        this.config = config;\n        this.migrations = migrations ? migrations : [];\n        this.hideInMenu = config.hideInMenu;\n        this.serialize = serialize ? serialize.bind(this) : this.serialize;\n        this.unserialize = unserialize ? unserialize.bind(this) : this.unserialize;\n        this.handleRemoveHotKey = handleRemoveHotKey\n            ? handleRemoveHotKey.bind(this)\n            : this.handleRemoveHotKey;\n        this.handleFocusNextHotKey = handleFocusNextHotKey\n            ? handleFocusNextHotKey.bind(this)\n            : this.handleFocusNextHotKey;\n        this.handleFocusPreviousHotKey = handleFocusPreviousHotKey\n            ? handleFocusPreviousHotKey.bind(this)\n            : this.handleFocusPreviousHotKey;\n        this.handleFocus = handleFocus ? handleFocus.bind(this) : this.handleFocus;\n        this.handleBlur = handleBlur ? handleBlur.bind(this) : this.handleBlur;\n        this.reducer = reducer ? reducer.bind(this) : this.reducer;\n    }\n    return Plugin;\n}());\nexport { Plugin };\n/**\n * @class this is the base class for content plugins.\n */\n// tslint:disable-next-line:no-any\nvar ContentPlugin = /** @class */ (function (_super) {\n    __extends(ContentPlugin, _super);\n    // tslint:disable-next-line:no-any\n    function ContentPlugin(config) {\n        var _this = _super.call(this, config) || this;\n        /**\n         * Create the plugin's initial state.\n         *\n         * @returns the initial state.\n         */\n        _this.createInitialState = function () { return ({}); };\n        /**\n         * Specify a custom reducer for the plugin's cell.\n         *\n         * @param state\n         * @param action\n         */\n        // tslint:disable-next-line:no-any\n        _this.reducer = function (state, action) { return state; };\n        var createInitialState = config.createInitialState, _a = config.allowInlineNeighbours, allowInlineNeighbours = _a === void 0 ? false : _a, _b = config.isInlineable, isInlineable = _b === void 0 ? false : _b;\n        _this.isInlineable = isInlineable;\n        _this.allowInlineNeighbours = allowInlineNeighbours;\n        _this.createInitialState = createInitialState\n            ? createInitialState.bind(_this)\n            : _this.createInitialState;\n        return _this;\n    }\n    return ContentPlugin;\n}(Plugin));\nexport { ContentPlugin };\n/**\n * @class this is the base class for layout plugins.\n */\n// tslint:disable-next-line:no-any\nvar LayoutPlugin = /** @class */ (function (_super) {\n    __extends(LayoutPlugin, _super);\n    function LayoutPlugin(config) {\n        var _this = _super.call(this, config) || this;\n        /**\n         * Create the plugin's initial state.\n         *\n         * @returns the initial state.\n         */\n        _this.createInitialState = function () { return ({}); };\n        /**\n         * Create the plugin's initial children (rows/cells).\n         *\n         * @returns the initial state.\n         */\n        // tslint:disable-next-line:no-any\n        _this.createInitialChildren = function () { return []; };\n        var createInitialState = config.createInitialState, createInitialChildren = config.createInitialChildren;\n        // child plugins\n        _this.plugins = config.plugins\n            ? {\n                content: config.plugins.content\n                    ? config.plugins.content.map(function (p) { return new ContentPlugin(p); })\n                    : null,\n                layout: config.plugins.layout\n                    ? config.plugins.layout.map(function (p) { return new LayoutPlugin(p); })\n                    : null,\n            }\n            : null;\n        _this.createInitialState = createInitialState\n            ? createInitialState.bind(_this)\n            : _this.createInitialState;\n        _this.createInitialChildren = createInitialChildren\n            ? createInitialChildren.bind(_this)\n            : _this.createInitialChildren;\n        return _this;\n    }\n    return LayoutPlugin;\n}(Plugin));\nexport { LayoutPlugin };\nvar NativePlugin = /** @class */ (function (_super) {\n    __extends(NativePlugin, _super);\n    // tslint:disable-next-line:no-any\n    function NativePlugin(config) {\n        var _this = _super.call(this, config) || this;\n        /**\n         * Create the plugin's initial children (rows/cells).\n         *\n         * @returns the initial state.\n         */\n        _this.createInitialChildren = function () { return []; };\n        /**\n         * Create the plugin's initial state.\n         *\n         * @returns the initial state.\n         */\n        // tslint:disable-next-line:no-any\n        _this.createInitialState = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return ({});\n        };\n        var createInitialState = config.createInitialState, _a = config.allowInlineNeighbours, allowInlineNeighbours = _a === void 0 ? false : _a, _b = config.isInlineable, isInlineable = _b === void 0 ? false : _b, createInitialChildren = config.createInitialChildren, _c = config.type, type = _c === void 0 ? 'content' : _c;\n        _this.isInlineable = isInlineable;\n        _this.allowInlineNeighbours = allowInlineNeighbours;\n        _this.createInitialState = createInitialState\n            ? createInitialState.bind(_this)\n            : _this.createInitialState;\n        _this.createInitialChildren = createInitialChildren\n            ? createInitialChildren.bind(_this)\n            : _this.createInitialChildren;\n        _this.type = type;\n        return _this;\n    }\n    return NativePlugin;\n}(Plugin));\nexport { NativePlugin };\n//# sourceMappingURL=classes.js.map"]},"metadata":{},"sourceType":"module"}